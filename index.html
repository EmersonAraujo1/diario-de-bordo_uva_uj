<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Diário de Bordo - Corporativo</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    /* Reset básico */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      background-color: #f5f7fa;
      color: #1f3a5f;
      min-height: 100vh;
      padding: 30px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }

    /* Cabeçalho simples */
    header {
      width: 100%;
      max-width: 900px;
      margin-bottom: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #1f3a5f;
      font-weight: 700;
      font-size: 1.25rem;
      letter-spacing: 1.5px;
    }
    header .logo {
      font-family: 'Inter', sans-serif;
    }

    nav {
      margin-bottom: 25px;
      width: 100%;
      max-width: 900px;
      display: flex;
      justify-content: center;
      gap: 18px;
      z-index: 10;
      position: relative;
    }
    nav button {
      background-color: #4a5a70;
      border: none;
      border-radius: 6px;
      padding: 12px 30px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.25s ease;
      user-select: none;
      box-shadow: 0 3px 6px rgba(74,90,112,0.3);
    }
    nav button:hover {
      background-color: #1f3a5f;
      box-shadow: 0 4px 8px rgba(31,58,95,0.5);
    }

    /* Contêineres */
    #formView, #adminView, #senhaAdmin {
      background-color: #ffffff;
      border-radius: 10px;
      padding: 30px 35px;
      max-width: 900px;
      width: 100%;
      box-shadow: 0 8px 20px rgba(31,58,95,0.1);
      color: #1f3a5f;
      display: none;
      flex-direction: column;
      position: relative;
      user-select: text;
    }

    h2 {
      color: #1f3a5f;
      margin-bottom: 25px;
      font-weight: 700;
      font-size: 2rem;
      text-align: center;
      letter-spacing: 1.2px;
    }

    label {
      font-weight: 600;
      margin-top: 18px;
      display: block;
      color: #4a5a70;
      font-size: 1rem;
    }

    input[type=text],
    input[type=password],
    select,
    textarea {
      width: 100%;
      padding: 12px 15px;
      margin-top: 6px;
      border-radius: 6px;
      border: 1.8px solid #d1d9e6;
      font-size: 1rem;
      background-color: #fefefe;
      color: #1f3a5f;
      font-family: 'Inter', sans-serif;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      resize: vertical;
      box-shadow: inset 0 0 6px rgba(31,58,95,0.1);
    }
    input[type=text]:focus,
    input[type=password]:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #1f3a5f;
      box-shadow: 0 0 10px rgba(31,58,95,0.3);
      background-color: #ffffff;
      color: #1f3a5f;
    }

    /* Botões */
    button {
      background-color: #4a5a70;
      border: none;
      border-radius: 8px;
      padding: 14px 30px;
      margin-top: 30px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      font-size: 1.1rem;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      box-shadow: 0 4px 10px rgba(74,90,112,0.3);
    }
    button:hover {
      background-color: #1f3a5f;
      box-shadow: 0 6px 18px rgba(31,58,95,0.5);
      transform: translateY(-2px);
    }
    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    /* Tabela Admin */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
      color: #1f3a5f;
      font-size: 1rem;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(31,58,95,0.1);
    }
    thead {
      background-color: #e1e6f0;
    }
    thead th {
      padding: 14px 12px;
      text-align: left;
      font-weight: 700;
      border-bottom: 2px solid #c0c7d6;
      color: #1f3a5f;
      letter-spacing: 0.8px;
    }
    tbody tr {
      border-bottom: 1px solid #dbe1ec;
      transition: background-color 0.3s ease;
    }
    tbody tr:hover {
      background-color: #f0f4fb;
    }
    tbody td {
      padding: 14px 10px;
      vertical-align: middle;
    }

    /* Status cores discretas */
    tbody tr.pendente {
      background-color: #fef1f1;
      color: #a42b2b;
      font-weight: 600;
    }
    tbody tr.tratativa {
      background-color: #fff8e5;
      color: #a67c00;
      font-weight: 600;
    }
    tbody tr.resolvido {
      background-color: #e6f0ff;
      color: #2a4da0;
      font-weight: 600;
    }

    /* Botões ação na tabela */
    .btn-table {
      background-color: #4a5a70;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 16px;
      font-weight: 600;
      cursor: pointer;
      margin-right: 8px;
      font-size: 0.9rem;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    .btn-table:hover {
      background-color: #1f3a5f;
    }
    .btn-table:active {
      transform: scale(0.95);
    }

    /* Filtros no admin */
    #adminView > div {
      display: flex;
      flex-wrap: wrap;
      gap: 22px;
      margin-bottom: 20px;
      align-items: center;
      justify-content: start;
    }
    #adminView label {
      margin: 0;
      font-weight: 600;
      color: #4a5a70;
      font-size: 1rem;
      min-width: 130px;
    }
    #adminView select,
    #adminView input[type=text] {
      max-width: 200px;
      padding: 10px 14px;
      border-radius: 6px;
      border: 1.8px solid #d1d9e6;
      background-color: #fafbfc;
      color: #1f3a5f;
      font-family: 'Inter', sans-serif;
      transition: border-color 0.3s ease;
      font-size: 1rem;
    }
    #adminView select:hover,
    #adminView input[type=text]:hover {
      border-color: #1f3a5f;
    }
    #adminView input[type=text]:focus,
    #adminView select:focus {
      outline: none;
      border-color: #1f3a5f;
      box-shadow: 0 0 10px rgba(31,58,95,0.3);
      color: #1f3a5f;
      background-color: #fff;
    }

    /* Notificação sucesso */
    #notificacao {
      color: #1f3a5f;
      font-weight: 700;
      font-size: 1.1rem;
      margin-top: 15px;
      text-align: center;
      user-select: none;
      min-height: 28px;
    }

    /* Responsivo */
    @media (max-width: 720px) {
      header {
        flex-direction: column;
        gap: 12px;
        text-align: center;
      }
      nav {
        flex-direction: column;
      }
      #adminView > div {
        flex-direction: column;
        align-items: stretch;
      }
      #adminView select, #adminView input[type=text] {
        max-width: 100%;
      }
      button {
        width: 100%;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo uva">Universidade Veiga de Almeida</div>
    <div class="logo unijorge">Unijorge</div>
  </header>

  <nav>
    <button onclick="toggleView('formView')">📋 Diário de Bordo</button>
    <button onclick="mostrarCampoSenha()">🔒 Admin</button>
  </nav>

  <div id="formView">
    <h2>Registro - Diário de Bordo</h2>
    <label for="nome">Nome:</label>
    <input type="text" id="nome" autocomplete="off" />

    <label for="cargo">Cargo:</label>
    <select id="cargo">
      <option>Consultor</option>
      <option>Assistente</option>
      <option>Analista</option>
      <option>Coordenador</option>
      <option>Gerência</option>
    </select>

    <label for="plataforma">Plataforma:</label>
    <select id="plataforma">
      <option>Botmaker</option>
      <option>Olos</option>
      <option>Eaglle</option>
      <option>Lyceum</option>
      <option>Internet</option>
    </select>

    <label for="motivo">Motivo do chamado:</label>
    <select id="motivo">
      <option>Queda</option>
      <option>Instabilidade</option>
      <option>Não consigo acessar</option>
      <option>Sem internet</option>
      <option>Não consigo conectar</option>
      <option>Outro</option>
    </select>

    <label for="obs">Observações:</label>
    <textarea id="obs" rows="3"></textarea>

    <button onclick="enviarFormulario()">🚀 Enviar</button>
    <div id="notificacao"></div>
  </div>

  <div id="senhaAdmin">
    <h2>🔐 Acesso Restrito</h2>
    <label for="senha">Digite a senha de administrador:</label>
    <input type="password" id="senha" placeholder="Senha" autocomplete="off" />
    <button onclick="validarSenha()">Entrar</button>
  </div>

  <div id="adminView">
    <h2>📊 Painel Administrativo</h2>

    <div>
      <label for="filtroStatus">Filtrar por status:</label>
      <select id="filtroStatus" onchange="filtrarChamados()">
        <option value="Todos">Todos</option>
        <option value="Pendente">Pendente</option>
        <option value="Em tratativa">Em tratativa</option>
        <option value="Resolvido">Resolvido</option>
      </select>

      <label for="filtroPlataforma">Plataforma:</label>
      <select id="filtroPlataforma" onchange="filtrarChamados()">
        <option value="Todas">Todas</option>
        <option>Botmaker</option>
        <option>Olos</option>
        <option>Eaglle</option>
        <option>Lyceum</option>
        <option>Internet</option>
      </select>

      <label for="buscaNome">Buscar por nome:</label>
      <input type="text" id="buscaNome" oninput="filtrarChamados()" placeholder="Digite um nome" />
    </div>

    <table id="tabelaChamados" aria-label="Tabela de chamados">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Cargo</th>
          <th>Plataforma</th>
          <th>Motivo</th>
          <th>Obs</th>
          <th>Data</th>
          <th>Hora</th>
          <th>Status</th>
          <th>Ação</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="exportarExcel()">📄 Exportar para Excel</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const chamados = JSON.parse(localStorage.getItem('chamados') || '[]');
      const senhaCorreta = "admin123";

      function salvarLocalStorage() {
        localStorage.setItem('chamados', JSON.stringify(chamados));
      }

      function toggleView(viewId) {
        ['formView', 'adminView', 'senhaAdmin'].forEach(id => {
          const el = document.getElementById(id);
          if (el) el.style.display = 'none';
        });
        const view = document.getElementById(viewId);
        if (view) view.style.display = 'flex';
      }

      function mostrarCampoSenha() {
        toggleView('senhaAdmin');
      }

      function validarSenha() {
        const senha = document.getElementById("senha").value;
        if (senha === senhaCorreta) {
          toggleView('adminView');
          atualizarTabela();
        } else {
          alert("Senha incorreta.");
        }
      }

      function enviarFormulario() {
        const nome = document.getElementById("nome").value.trim();
        const cargo = document.getElementById("cargo").value;
        const plataforma = document.getElementById("plataforma").value;
        const motivo = document.getElementById("motivo").value;
        const obs = document.getElementById("obs").value.trim();

        if (!nome) {
          alert("Por favor, preencha o nome.");
          return;
        }

        const dataAtual = new Date();
        const data = dataAtual.toLocaleDateString('pt-BR');
        const hora = dataAtual.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });

        const registro = {
          nome,
          cargo,
          plataforma,
          motivo,
          obs,
          data,
          hora,
          status: "Pendente"
        };

        chamados.push(registro);
        salvarLocalStorage();
        atualizarTabela();

        document.querySelectorAll('#formView input, #formView textarea').forEach(el => el.value = '');
        document.getElementById("notificacao").textContent = "✅ Chamado registrado com sucesso!";
        setTimeout(() => document.getElementById("notificacao").textContent = "", 4000);
      }

      function marcarTratativa(index) {
        chamados[index].status = "Em tratativa";
        salvarLocalStorage();
        atualizarTabela();
      }

      function resolverChamado(index) {
        chamados[index].status = "Resolvido";
        salvarLocalStorage();
        atualizarTabela();
      }

      function atualizarTabela() {
        const filtroStatus = document.getElementById("filtroStatus")?.value || "Todos";
        const filtroPlataforma = document.getElementById("filtroPlataforma")?.value || "Todas";
        const buscaNome = document.getElementById("buscaNome")?.value.toLowerCase() || "";

        const tbody = document.querySelector("#tabelaChamados tbody");
        tbody.innerHTML = "";

        chamados.forEach((c, i) => {
          if (filtroStatus !== "Todos" && c.status !== filtroStatus) return;
          if (filtroPlataforma !== "Todas" && c.plataforma !== filtroPlataforma) return;
          if (buscaNome && !c.nome.toLowerCase().includes(buscaNome)) return;

          const tr = document.createElement("tr");
          tr.className = c.status === "Pendente" ? "pendente"
            : c.status === "Em tratativa" ? "tratativa"
            : "resolvido";

          tr.innerHTML = `
            <td>${c.nome}</td>
            <td>${c.cargo}</td>
            <td>${c.plataforma}</td>
            <td>${c.motivo}</td>
            <td>${c.obs}</td>
            <td>${c.data}</td>
            <td>${c.hora}</td>
            <td>${c.status}</td>
            <td>
              ${c.status !== "Resolvido" ? `
                <button class="btn-table" onclick="marcarTratativa(${i})" aria-label="Marcar chamado como em tratativa">🔧 Tratativa</button>
                <button class="btn-table" onclick="resolverChamado(${i})" aria-label="Marcar chamado como resolvido">✔️ Resolver</button>
              ` : '—'}
            </td>
          `;
          tbody.appendChild(tr);
        });
      }

      function filtrarChamados() {
        atualizarTabela();
      }

      function exportarExcel
